package com.dfn.watchdog;

/**
 * Server main method.
 * <p>
 * <p>
 * Agent                              Server
 * |                                   |
 * +-------------------------------------------------------------------+
 * |                           ChannelPipeline                         |
 * |                                                                   |
 * |    +---------------------+            +----------------------+    |
 * |    |   Encoder/Decoder   |------------|   Encoder/Decoder    |    |
 * |    +----------+----------+            +-----------+----------+    |
 * |               |                                   |               |
 * |               |                                   |               |
 * |    +----------+----------+                        |               |
 * |    |  ReadTimeoutHandler |                        |               |
 * |    +----------+----------+                        |               |
 * |               |                                   |               |
 * |               |                                   |               |
 * |    +----------+----------+                        |               |
 * |    | ReconnectionHandler |                        |               |
 * |    +----------+----------+                        |               |
 * |              \|/                                  |               |
 * |               |                                   |               |
 * |    +----------+----------+            +-----------+----------+    |
 * |    |  HeartbeatHandler   |------------|   HeartbeatHandler   |    |
 * |    +----------+----------+            +-----------+----------+    |
 * |              \|/                                  |               |
 * |               |                                  \|/              |
 * |    +----------+----------+            +-----------+----------+    |
 * |    |     RouteHandler    |------------|     RouteHandler     |    |
 * |    +----------+----------+            +-----------+----------+    |
 * |              \|/                                  |               |
 * |               |                                  \|/              |
 * |    +----------+----------+            +-----------+----------+    |
 * |    |     JoinHandler     |------------|      JoinHandler     |    |
 * |    +----------+----------+            +-----------+----------+    |
 * |              \|/                                  |               |
 * |               |                                  \|/              |
 * |    +----------+----------+            +-----------+----------+    |
 * |    | ChangeStateHandler  |------------|  ChangeStateHandler  |    |
 * |    +----------+----------+            +-----------+----------+    |
 * |              \|/                                  |               |
 * |               |                                  \|/              |
 * |    +----------+----------+            +-----------+----------+    |
 * |    |    Other messages   |------------|   Other messages     |    |
 * |    +----------+----------+            +-----------+----------+    |
 * |               |                                   |               |
 * +---------------+-----------------------------------+---------------+
 */
public class MainServer {
    public static void main(String[] args) {
        if (args.length > 0) {
            WatchdogServer.INSTANCE.configure(args[0]).run();
        } else {
            try {
                WatchdogServer.INSTANCE.configure().run().channel().closeFuture().sync();
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }
    }
}
